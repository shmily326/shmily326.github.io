---
layout: post
title: 《和阿铭学Linux》摘录
categories: [Linux]
description: 摘抄自《和阿铭学Linux》
keywords: Linux, 笔记
---

# Linux 学习笔记

# Linux文件和目录管理
## 绝对路径和相对路径

 - `cd`  （change diretory) 若后面什么都不接，则进入当前用户根目录/root
 - `mkdir [-mp] 目录名称`  -m 指定创建目录的权限 -p 可以创建一连串目录，若已存在则不做任何事
 - `rmdir`  可以-p，但只能删除空文件夹
 - `rm`  -r 可删除非空目录，会询问是否删除 -f 表示强制删除，不会询问，且若删除不存在目录、不报错，若不加 -r 去删除一个存在的目录、报错; 最常用的为 `rm -rf`，**但千万不能加  /**
 - `echo` 打印， 使用>和>>重定向， 即把前面的内容输入到后面的文件中，前者会覆盖原有内容，后者是追加的意思

## 环境变量PATH
 - `which`  查找某个命令的绝对路径（只能查找PATH环境变量中出现的路径下的可执行文件）
 - `cp [选项] 来源文件 目的文件`  ，复制目录需 -r，-i 会询问是否覆盖
 - `touch` 若有这个文件则修改该文件的访问日期，若无则创建这个文件
 - `mv [选项] 源文件或目录 目标文件或目录`  移动目录或文件、重命名

## 文档相关命令
 - `cat` -n显示行号， -A显示所有内容，包括特殊字符
 - `tac` 将文件从后至前逐行输出
 - `more` 当文件过多时，cat无法查看前面内容，则用more从头开始，空格下一屏，Ctrl+D(F)上(下)一屏，看完自动结束，q可提前结束
 - `less` 作用和more一样，但有更多功能。空格翻页，j(k) 向下(上)移动一行；二者都支持使用/或?搜索字符串，前者从当前行向下搜索，后者向前，按n可显示下一个
 - `head` 显示文件的前10行， -n 显示文件的前几行，可省略n
 - `tail` 显示文件的最后10行， -n 同上， -f 可以动态、实时地显示文件的最后10行， 如日志信息

## 文件的所有者和所属组

```
    drwxr-xr-x. 2 huige huige      6 10月 13 11:51 hsperfdata_huige
```

### 共有9列内容

 - 第1列：文件类型，所有者、所属组、其他用户对该文件的权限（每三位一组， 读、写、执行）；其中第一位文件类型有（d : 目录，- ： 普通文件， l : 链接文件， b : 设备块、磁盘分区文件， c : 串行端口设备文件， s ： 套接字文件socket用于进程间通信）
 - 第2列：该文件占用的节点， 例如目录则该数值与该目录下子目录数量有关
 - 第3列：该文件的所有者
 - 第4列：该文件的所属组
 - 第5列：该文件的大小
 - 第6、7、8列：文件最后一次被修改的时间
 - 第9列：文件名

## 更改文件的权限
 - `groupadd` 增加一个用户组
 - `chgrp 组名 文件名`  更改文件或目录的所属组， -R 级联更改子目录以及子文件
 - `chown [-R] 账户名(:组名) 文件名` 更改文件的所有者
 - `chmod [-R] xyz(数字) 文件名` r 等于4, w 等于2， x 等于1， - 等于0， rwxrwx--- 用数字表示为770， Linux中一个目录的默认权限是755， 文件默认权限是644； chmod还支持使用 u、g、o、a，直接用rwx对其赋值来设置权限， `chmod u=rwx,og=rx dir_test`， 也可以增加或减少某个权限 `chmod u-x,g+w dir_test`
 - `umask xxx(数字)` 改变文件的默认权限， root默认值为0022(----w--w-， 第一个0表示八进制),   而普通用户为002
 两条规则：
    * 若用户建立普通文件，则预设只有r、w两个权限， 最大值为666(-rw-rw-rw-)
    * 若用户建立目录，则预设所有权限开放， 最大值为777(drwxrwxrwx), 对目录的执行也就是打开
    * umask数值代表的含义为以上两条规则中的默认值(666、777)需要减掉的权限， 目录的权限为rwxrwxrwx - ----w--w- = rwxr-xr-x

## 修改文件的特殊属性
 - `chattr [+-=] [Asaci] 文件/目录名`
    a : 只能追加而不能删除， 非root用户不能设定该属性
    i : 文件不能删除、重命名、设定链接、写入以及新增数据
    A : 文件或目录的atime不可修改
    s : 将数据同步写入到磁盘中
    c : 自动压缩该文件， 读取时自动解压
 - `lsattr [-aR] 文件/目录名`
    -a : 类似于ls的-a, 连同隐藏文件一起列出
    -R : 连同子目录的数据一起列出
 - `set uid , set gid , sticky bit`
    * set uid : 使二进制可执行文件在执行阶段具有文件所有者的权限， 比如passwd就有该权限， 使得普通用户在执行该命令时可获得root权限， 从而可以更改密码
    * set gid : 使进级制可执行文件或目录在执行阶段具有文件所属组的权限， 目录被设置这个权限后， 任何用户在此目录下创建的文件都具有和该目录所属的组相同的组
    * sticky bit : 可理解为防删除位，对目录设置该权限后，用户能够添加文件但不能删除该目录下其他用户的文件

 -  `chmod u+s filename` `chmod g-s dirname` `chmod o+t dirname`
    * 在前面介绍权限时只有3位数， 实际上前面还有1位， rws用数字表示为4755， 当有特殊权限时第1位数字表示为 0、 1(--t) 、 2(-s-)、 3(-st)、 4(s--)、 5(s-t)、 6(ss-)、 7(sst)

```
    [root@localhost tmp]# l -l /usr/bin/passwd
    -rwsr-xr-x. 1 root root 27832 6月  10 2014 /usr/bin/passwd
```

## 在Linux下搜索文件
 - `find 路径 [参数]` 最常用的一个
    * -atime +n/-n : access time, 表示访问或执行时间大于或小于n天的文件
    * -ctime +n/-n : change time, 表示写入、更改inode属性（所有者、权限、链接）的时间大于或小于n天的文件
    * -mtime +n/-n : 表示写入时间大于或小于n天的文件
 - `stat` 可以列出文件的上述三个信息
    * -name filename : 表示直接查找该文件名的文件
    * -type filename : 表示通过文件类型查找文件
 - `find . -name "test*"`  * 表示通配
 - `find . -type d` 查找目录
 - `which`  查找某个命令的绝对路径（只能查找PATH环境变量中出现的路径下的可执行文件）
 - `whereis [-bms] 文件名称` 通过先前生成的一个文件列表库查找与给出的文件名相关的文件， 类似于模糊查找
    *  -b : 只查找二进制文件
    *  -m : 只查找帮助文件(在man目录下的文件)
    *  -s : 只查找源代码文件
```
    [root@localhost tmp]# whereis ls
    ls: /usr/bin/ls /usr/share/man/man1/ls.1.gz /usr/share/man/man1p/ls.1p.gz
```

 - `locate 文件名` 类似于whereis
